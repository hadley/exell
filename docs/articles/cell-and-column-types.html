<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cell and Column Types • readxl</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- tidyverse --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">readxl</a>
        <small class="tidyverse">part of the <a href="http://tidyverse.org">tidyverse</a></small>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cell-and-column-types.html">Column Types</a>
    </li>
    <li>
      <a href="../articles/sheet-geometry.html">Sheet Geometry</a>
    </li>
    <li>
      <a href="../articles/articles/readxl-workflows.html">Workflows</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        <li>
  <a href="https://github.com/tidyverse/readxl">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Cell and Column Types</h1>
            
          </div>

    
    
<div class="contents">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readxl)</code></pre></div>
<p><code>readxl::read_excel()</code> will guess column types, by default, or you can provide them explicitly via the <code>col_types</code> argument. The <code>col_types</code> argument is more flexible than you might think; you can mix actual types in with <code>"skip"</code> and <code>"guess"</code> and a single type will be recycled to the necessary length.</p>
<p>Here are different ways this might look:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/read_excel.html">read_excel</a></span>(<span class="st">"yo.xlsx"</span>)
<span class="kw"><a href="../reference/read_excel.html">read_excel</a></span>(<span class="st">"yo.xlsx"</span>, <span class="dt">col_types =</span> <span class="st">"numeric"</span>)
<span class="kw"><a href="../reference/read_excel.html">read_excel</a></span>(<span class="st">"yo.xlsx"</span>, <span class="dt">col_types =</span> <span class="kw">c</span>(<span class="st">"date"</span>, <span class="st">"skip"</span>, <span class="st">"guess"</span>, <span class="st">"numeric"</span>))</code></pre></div>
<div id="type-guessing" class="section level2">
<h2 class="hasAnchor">
<a href="#type-guessing" class="anchor"></a>Type guessing</h2>
<p>If you use other packages in the <a href="http://tidyverse.org">tidyverse</a>, you are probably familiar with <a href="http://readr.tidyverse.org">readr</a>, which reads data from flat files. Like readxl, readr also provides column type guessing, but readr and readxl are very different under the hood.</p>
<ul>
<li>readr guesses column type <em>based on the data</em>.</li>
<li>readxl guesses column type <em>based on Excel cell types</em>.</li>
</ul>
<p>Each cell in an Excel spreadsheet has its own type. For all intents and purposes, they are:</p>
<p>       empty &lt; boolean &lt; numeric &lt; text</p>
<p>with the wrinkle that datetimes are a very special flavor of numeric. A cell of any particular type can always be represented as one of any higher type and, possibly, as one of lower type. When guessing, <code><a href="../reference/read_excel.html">read_excel()</a></code> keeps a running “maximum” on the cell types it has seen in any given column. Once it has visited <code>guess_max</code> rows or run out of data, this is the guessed type for that column. There is a strong current towards “text”, the column type of last resort.</p>
<p>Here’s an example of column guessing with <code>deaths.xlsx</code> which ships with readxl.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/read_excel.html">read_excel</a></span>(<span class="kw"><a href="../reference/readxl_example.html">readxl_example</a></span>(<span class="st">"deaths.xlsx"</span>), <span class="dt">range =</span> <span class="kw"><a href="../reference/cell-specification.html">cell_rows</a></span>(<span class="dv">5</span>:<span class="dv">15</span>))
<span class="co">#&gt; # A tibble: 10 × 6</span>
<span class="co">#&gt;            Name Profession   Age `Has kids` `Date of birth`</span>
<span class="co">#&gt;           &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;      &lt;lgl&gt;          &lt;dttm&gt;</span>
<span class="co">#&gt; 1   David Bowie   musician    69       TRUE      1947-01-08</span>
<span class="co">#&gt; 2 Carrie Fisher      actor    60       TRUE      1956-10-21</span>
<span class="co">#&gt; 3   Chuck Berry   musician    90       TRUE      1926-10-18</span>
<span class="co">#&gt; 4   Bill Paxton      actor    61       TRUE      1955-05-17</span>
<span class="co">#&gt; # ... with 6 more rows, and 1 more variables: `Date of death` &lt;dttm&gt;</span></code></pre></div>
</div>
<div id="excel-types-r-types-col_types" class="section level2">
<h2 class="hasAnchor">
<a href="#excel-types-r-types-col_types" class="anchor"></a>Excel types, R types, <code>col_types</code>
</h2>
<p>Here’s how the Excel cell/column types are translated into R types and how to force the type explicitly in <code>col_types</code>:</p>
<table style="width:110%;" class="table">
<colgroup>
<col width="29%">
<col width="36%">
<col width="44%">
</colgroup>
<thead><tr class="header">
<th align="left">How it is in Excel</th>
<th align="left">How it will be in R</th>
<th align="left">How to request in <code>col_types</code>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><em>anything</em></td>
<td align="left"><em>non-existent</em></td>
<td align="left"><code>"skip"</code></td>
</tr>
<tr class="even">
<td align="left">empty</td>
<td align="left">
<code>logical</code>, but all <code>NA</code>
</td>
<td align="left"><em>you cannot request this</em></td>
</tr>
<tr class="odd">
<td align="left">boolean</td>
<td align="left"><code>logical</code></td>
<td align="left"><code>"logical"</code></td>
</tr>
<tr class="even">
<td align="left">numeric</td>
<td align="left"><code>numeric</code></td>
<td align="left"><code>"numeric"</code></td>
</tr>
<tr class="odd">
<td align="left">datetime</td>
<td align="left"><code>POSIXct</code></td>
<td align="left"><code>"date"</code></td>
</tr>
<tr class="even">
<td align="left">text</td>
<td align="left"><code>character</code></td>
<td align="left"><code>"text"</code></td>
</tr>
<tr class="odd">
<td align="left"><em>anything</em></td>
<td align="left"><code>list</code></td>
<td align="left"><code>"list"</code></td>
</tr>
</tbody>
</table>
<p>Some explanation about the weird cases in the first two rows:</p>
<ul>
<li>If a column falls in your data rectangle, but you do not want an associated variable in the output, specify the column type <code>"skip"</code>. Internally, these cells may be visited in order to learn their location, but they are not loaded and their data is never read.</li>
<li>You cannot request that a column be included but filled with <code>NA</code>s. Such a column can arise naturally, if all the cells are empty, or you can skip a column (see previous point).</li>
</ul>
<p>Example of skipping and guessing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/read_excel.html">read_excel</a></span>(
  <span class="kw"><a href="../reference/readxl_example.html">readxl_example</a></span>(<span class="st">"deaths.xlsx"</span>),
  <span class="dt">range =</span> <span class="kw"><a href="../reference/cell-specification.html">cell_rows</a></span>(<span class="dv">5</span>:<span class="dv">15</span>),
  <span class="dt">col_types =</span> <span class="kw">c</span>(<span class="st">"guess"</span>, <span class="st">"skip"</span>, <span class="st">"guess"</span>, <span class="st">"skip"</span>, <span class="st">"skip"</span>, <span class="st">"skip"</span>)
)
<span class="co">#&gt; # A tibble: 10 × 2</span>
<span class="co">#&gt;            Name   Age</span>
<span class="co">#&gt;           &lt;chr&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1   David Bowie    69</span>
<span class="co">#&gt; 2 Carrie Fisher    60</span>
<span class="co">#&gt; 3   Chuck Berry    90</span>
<span class="co">#&gt; 4   Bill Paxton    61</span>
<span class="co">#&gt; # ... with 6 more rows</span></code></pre></div>
<p>More about the <code>"list"</code> column type in the last row:</p>
<ul>
<li>This will create a list-column in the output, each component of which is a length one atomic vector. The type of these vectors is determined using the logic described above. This can be useful if data of truly disparate type is arranged in a column.</li>
</ul>
<p>We demonstrate the <code>"list"</code> column type using the <code>clippy.xlsx</code> sheet that ship with Excel. Its second column holds information about Clippy that would be really hard to store with just one type.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(clippy &lt;-<span class="st"> </span>
<span class="st">   </span><span class="kw"><a href="../reference/read_excel.html">read_excel</a></span>(<span class="kw"><a href="../reference/readxl_example.html">readxl_example</a></span>(<span class="st">"clippy.xlsx"</span>), <span class="dt">col_types =</span> <span class="kw">c</span>(<span class="st">"text"</span>, <span class="st">"list"</span>)))
<span class="co">#&gt; # A tibble: 4 × 2</span>
<span class="co">#&gt;                   name      value</span>
<span class="co">#&gt;                  &lt;chr&gt;     &lt;list&gt;</span>
<span class="co">#&gt; 1                 Name  &lt;chr [1]&gt;</span>
<span class="co">#&gt; 2              Species  &lt;chr [1]&gt;</span>
<span class="co">#&gt; 3 Approx date of death &lt;dttm [1]&gt;</span>
<span class="co">#&gt; 4      Weight in grams  &lt;dbl [1]&gt;</span>
tibble::<span class="kw">deframe</span>(clippy)
<span class="co">#&gt; $Name</span>
<span class="co">#&gt; [1] "Clippy"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Species</span>
<span class="co">#&gt; [1] "paperclip"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`Approx date of death`</span>
<span class="co">#&gt; [1] "2007-01-01 UTC"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`Weight in grams`</span>
<span class="co">#&gt; [1] 0.9</span>
<span class="kw">sapply</span>(clippy$value, class)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] "character"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] "character"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] "POSIXct" "POSIXt" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] "numeric"</span></code></pre></div>
<p>Final note: all datetimes are imported as having the UTC timezone, because, mercifully, Excel has no notion of timezones.</p>
</div>
<div id="when-column-guessing-goes-wrong" class="section level2">
<h2 class="hasAnchor">
<a href="#when-column-guessing-goes-wrong" class="anchor"></a>When column guessing goes wrong</h2>
<p>It’s pretty common to expect a column to import as, say, numeric or datetime. And to then be sad when it imports as character instead. Two main causes:</p>
<p><strong>Contamination by embedded missing or bad data of incompatible type.</strong> Example: missing data entered as <code>??</code> in a numeric column.</p>
<ul>
<li>Fix: use the <code>na</code> argument of <code><a href="../reference/read_excel.html">read_excel()</a></code> to describe all possible forms for missing data. This should prevent such cells from influencing type guessing and cause them to import as <code>NA</code> of the appropriate type.</li>
</ul>
<p><em>hmm … none of the example sheets make a great demo here</em></p>
<p><strong>Contamination of the data rectangle by leading or trailing non-data rows.</strong> Example: the sheet contains a few lines of explanatory prose before the data table begins.</p>
<ul>
<li>Fix: specify the target rectangle. Use <code>skip</code> and <code>n_max</code> to provide a minimum number of rows to skip and a maximum number of data rows to read, respectively. Or use the more powerful <code>range</code> argument to describe the cell rectangle in various ways. See the examples for <code><a href="../reference/read_excel.html">read_excel()</a></code> help or <code><a href="../articles/sheet-geometry.html">vignette("sheet-geometry")</a></code> for more detail.</li>
</ul>
<p>The <code>deaths.xlsx</code> sheet demonstrates this perfectly. Here’s how it imports if we don’t specify <code>range</code> as we did above:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">deaths &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_excel.html">read_excel</a></span>(<span class="kw"><a href="../reference/readxl_example.html">readxl_example</a></span>(<span class="st">"deaths.xlsx"</span>))
<span class="kw">print</span>(deaths, <span class="dt">n =</span> <span class="ot">Inf</span>)
<span class="co">#&gt; # A tibble: 18 × 6</span>
<span class="co">#&gt;                `Lots of people`                     X__1   X__2     X__3</span>
<span class="co">#&gt;                           &lt;chr&gt;                    &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;</span>
<span class="co">#&gt; 1  simply cannot resist writing                     &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 2                            at                      the    top     &lt;NA&gt;</span>
<span class="co">#&gt; 3                            or                  merging   &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 4                          Name               Profession    Age Has kids</span>
<span class="co">#&gt; 5                   David Bowie                 musician     69     TRUE</span>
<span class="co">#&gt; 6                 Carrie Fisher                    actor     60     TRUE</span>
<span class="co">#&gt; 7                   Chuck Berry                 musician     90     TRUE</span>
<span class="co">#&gt; 8                   Bill Paxton                    actor     61     TRUE</span>
<span class="co">#&gt; 9                        Prince                 musician     57     TRUE</span>
<span class="co">#&gt; 10                 Alan Rickman                    actor     69    FALSE</span>
<span class="co">#&gt; 11           Florence Henderson                    actor     82     TRUE</span>
<span class="co">#&gt; 12                   Harper Lee                   author     89    FALSE</span>
<span class="co">#&gt; 13                Zsa Zsa Gábor                    actor     99     TRUE</span>
<span class="co">#&gt; 14               George Michael                 musician     53    FALSE</span>
<span class="co">#&gt; 15                         Some                     &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 16                         &lt;NA&gt; also like to write stuff   &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 17                         &lt;NA&gt;                     &lt;NA&gt; at the  bottom,</span>
<span class="co">#&gt; 18                         &lt;NA&gt;                     &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; # ... with 2 more variables: X__4 &lt;chr&gt;, X__5 &lt;chr&gt;</span></code></pre></div>
<p>Non-data rows above and below the main data rectangle are causing all the columns to import as character.</p>
<p>If your column typing problem can’t be solved by specifying <code>na</code> or the data rectangle, request the <code>"list"</code> column type and handle missing data and coercion after import.</p>
</div>
<div id="square-pegs-in-round-holes" class="section level2">
<h2 class="hasAnchor">
<a href="#square-pegs-in-round-holes" class="anchor"></a>Square pegs in round holes</h2>
<p>You can force a column to have a specific type via <code>col_types</code>. So what happens to cells of another type? They will either be coerced to the requested type or to an <code>NA</code> of appropriate type.</p>
<p>For each column type, below we present a screen shot of a sheet from the built-in example <code>type-me.xlsx</code>. We force the first column to have a specific type and the second column explains what is in the first. You’ll see how mismatches between cell type and column type are resolved.</p>
<div id="logical-column" class="section level3">
<h3 class="hasAnchor">
<a href="#logical-column" class="anchor"></a>Logical column</h3>
<p>A numeric cell is coerced to <code>FALSE</code> if it is zero and <code>TRUE</code> otherwise. A date cell becomes <code>NA</code>. Just like in R, the strings “T”, “TRUE”, “True”, and “true” are regarded as <code>TRUE</code> and “F”, “FALSE”, “False”, “false” as <code>FALSE</code>. Other strings import as <code>NA</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_excel.html">read_excel</a></span>(<span class="kw"><a href="../reference/readxl_example.html">readxl_example</a></span>(<span class="st">"type-me.xlsx"</span>), <span class="dt">sheet =</span> <span class="st">"logical_coercion"</span>,
                 <span class="dt">col_types =</span> <span class="kw">c</span>(<span class="st">"logical"</span>, <span class="st">"text"</span>))
<span class="co">#&gt; Warning in read_fun(path = path, sheet = sheet, limits = limits, shim =</span>
<span class="co">#&gt; shim, : Expecting logical in [5, 1]: got a date</span>
<span class="co">#&gt; Warning in read_fun(path = path, sheet = sheet, limits = limits, shim =</span>
<span class="co">#&gt; shim, : Expecting logical in [8, 1] got 'cabbage'</span>
<span class="kw">print</span>(df, <span class="dt">n =</span> <span class="ot">Inf</span>)
<span class="co">#&gt; # A tibble: 10 × 2</span>
<span class="co">#&gt;    `maybe boolean?`                      description</span>
<span class="co">#&gt;               &lt;lgl&gt;                            &lt;chr&gt;</span>
<span class="co">#&gt; 1                NA                            empty</span>
<span class="co">#&gt; 2             FALSE                      0 (numeric)</span>
<span class="co">#&gt; 3              TRUE                      1 (numeric)</span>
<span class="co">#&gt; 4                NA                         datetime</span>
<span class="co">#&gt; 5              TRUE                     boolean true</span>
<span class="co">#&gt; 6             FALSE                    boolean false</span>
<span class="co">#&gt; 7                NA                        "cabbage"</span>
<span class="co">#&gt; 8              TRUE                the string "true"</span>
<span class="co">#&gt; 9             FALSE                   the letter "F"</span>
<span class="co">#&gt; 10            FALSE "False" preceded by single quote</span></code></pre></div>
<p><img src="type-me-logical.png" width="70%"></p>
</div>
<div id="numeric-column" class="section level3">
<h3 class="hasAnchor">
<a href="#numeric-column" class="anchor"></a>Numeric column</h3>
<p>A boolean cell is coerced to zero if <code>FALSE</code> and one if <code>TRUE</code>. A datetime comes in as the underlying serial date, which is the number of days, possibly fractional, since the <a href="https://support.microsoft.com/en-us/help/214330/differences-between-the-1900-and-the-1904-date-system-in-excel">date origin</a>. For text, numeric conversion is attempted, to handle the “number as text” phenomenon. If unsuccessful, text cells import as <code>NA</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_excel.html">read_excel</a></span>(<span class="kw"><a href="../reference/readxl_example.html">readxl_example</a></span>(<span class="st">"type-me.xlsx"</span>), <span class="dt">sheet =</span> <span class="st">"numeric_coercion"</span>,
                 <span class="dt">col_types =</span> <span class="kw">c</span>(<span class="st">"numeric"</span>, <span class="st">"text"</span>))
<span class="co">#&gt; Warning in read_fun(path = path, sheet = sheet, limits = limits, shim =</span>
<span class="co">#&gt; shim, : Coercing boolean to numeric in [3, 1]</span>
<span class="co">#&gt; Warning in read_fun(path = path, sheet = sheet, limits = limits, shim =</span>
<span class="co">#&gt; shim, : Coercing boolean to numeric in [4, 1]</span>
<span class="co">#&gt; Warning in read_fun(path = path, sheet = sheet, limits = limits, shim =</span>
<span class="co">#&gt; shim, : Expecting numeric in [5, 1]: got a date</span>
<span class="co">#&gt; Warning in read_fun(path = path, sheet = sheet, limits = limits, shim =</span>
<span class="co">#&gt; shim, : Coercing text to numeric in [6, 1]: '123456'</span>
<span class="co">#&gt; Warning in read_fun(path = path, sheet = sheet, limits = limits, shim =</span>
<span class="co">#&gt; shim, : Expecting numeric in [8, 1]: got 'cabbage'</span>
<span class="kw">print</span>(df, <span class="dt">n =</span> <span class="ot">Inf</span>)
<span class="co">#&gt; # A tibble: 7 × 2</span>
<span class="co">#&gt;   `maybe numeric?`         explanation</span>
<span class="co">#&gt;              &lt;dbl&gt;               &lt;chr&gt;</span>
<span class="co">#&gt; 1               NA               empty</span>
<span class="co">#&gt; 2                1        boolean true</span>
<span class="co">#&gt; 3                0       boolean false</span>
<span class="co">#&gt; 4            40534            datetime</span>
<span class="co">#&gt; 5           123456 the string "123456"</span>
<span class="co">#&gt; 6           123456   the number 123456</span>
<span class="co">#&gt; 7               NA           "cabbage"</span></code></pre></div>
<p><img src="type-me-numeric.png" width="70%"></p>
</div>
<div id="date-column" class="section level3">
<h3 class="hasAnchor">
<a href="#date-column" class="anchor"></a>Date column</h3>
<p>A numeric cell is interpreted as a serial date (<em>I’m questioning whether this is wise, but <a href="https://github.com/tidyverse/readxl/issues/266" class="uri">https://github.com/tidyverse/readxl/issues/266</a></em>). Boolean or text cells become <code>NA</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_excel.html">read_excel</a></span>(<span class="kw"><a href="../reference/readxl_example.html">readxl_example</a></span>(<span class="st">"type-me.xlsx"</span>), <span class="dt">sheet =</span> <span class="st">"date_coercion"</span>,
                 <span class="dt">col_types =</span> <span class="kw">c</span>(<span class="st">"date"</span>, <span class="st">"text"</span>))
<span class="co">#&gt; Warning in read_fun(path = path, sheet = sheet, limits = limits, shim =</span>
<span class="co">#&gt; shim, : Expecting date in [5, 1]: got boolean</span>
<span class="co">#&gt; Warning in read_fun(path = path, sheet = sheet, limits = limits, shim =</span>
<span class="co">#&gt; shim, : Expecting date in [6, 1]: got 'cabbage'</span>
<span class="co">#&gt; Warning in read_fun(path = path, sheet = sheet, limits = limits, shim =</span>
<span class="co">#&gt; shim, : Coercing numeric to date in [7, 1]</span>
<span class="co">#&gt; Warning in read_fun(path = path, sheet = sheet, limits = limits, shim =</span>
<span class="co">#&gt; shim, : Coercing numeric to date in [8, 1]</span>
<span class="kw">print</span>(df, <span class="dt">n =</span> <span class="ot">Inf</span>)
<span class="co">#&gt; # A tibble: 7 × 2</span>
<span class="co">#&gt;   `maybe a datetime?`          explanation</span>
<span class="co">#&gt;                &lt;dttm&gt;                &lt;chr&gt;</span>
<span class="co">#&gt; 1                &lt;NA&gt;                empty</span>
<span class="co">#&gt; 2 2016-05-23 00:00:00     date only format</span>
<span class="co">#&gt; 3 2016-04-28 11:30:00 date and time format</span>
<span class="co">#&gt; 4                &lt;NA&gt;         boolean true</span>
<span class="co">#&gt; 5                &lt;NA&gt;            "cabbage"</span>
<span class="co">#&gt; 6 1904-01-05 07:12:00        4.3 (numeric)</span>
<span class="co">#&gt; 7 2012-01-02 00:00:00      another numeric</span></code></pre></div>
<p><img src="type-me-date.png" width="70%"></p>
</div>
<div id="text-or-character-column" class="section level3">
<h3 class="hasAnchor">
<a href="#text-or-character-column" class="anchor"></a>Text or character column</h3>
<p>A boolean cell becomes either <code>"TRUE"</code> or <code>"FALSE"</code>. A numeric cell is converted to character, much like <code>as.character()</code> in R. A date cell is handled like numeric, using the underlying serial value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_excel.html">read_excel</a></span>(<span class="kw"><a href="../reference/readxl_example.html">readxl_example</a></span>(<span class="st">"type-me.xlsx"</span>), <span class="dt">sheet =</span> <span class="st">"text_coercion"</span>,
                 <span class="dt">col_types =</span> <span class="kw">c</span>(<span class="st">"text"</span>, <span class="st">"text"</span>))
<span class="kw">print</span>(df, <span class="dt">n =</span> <span class="ot">Inf</span>)
<span class="co">#&gt; # A tibble: 6 × 2</span>
<span class="co">#&gt;       text     explanation</span>
<span class="co">#&gt;      &lt;chr&gt;           &lt;chr&gt;</span>
<span class="co">#&gt; 1     &lt;NA&gt;           empty</span>
<span class="co">#&gt; 2  cabbage       "cabbage"</span>
<span class="co">#&gt; 3     TRUE    boolean true</span>
<span class="co">#&gt; 4      1.3         numeric</span>
<span class="co">#&gt; 5    41175        datetime</span>
<span class="co">#&gt; 6 36436153 another numeric</span></code></pre></div>
<p><img src="type-me-text.png" width="70%"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#type-guessing">Type guessing</a></li>
      <li><a href="#excel-types-r-types-col_types">Excel types, R types, <code>col_types</code></a></li>
      <li><a href="#when-column-guessing-goes-wrong">When column guessing goes wrong</a></li>
      <li><a href="#square-pegs-in-round-holes">Square pegs in round holes</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="tidyverse">
  <p>readxl is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="http://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>Developed by <a href="http://hadley.nz">Hadley Wickham</a>, Jennifer Bryan, <a href="https://www.rstudio.com"><img src="http://tidyverse.org/rstudio-logo.svg" height="24"></a>.</p>
  <p>Site built by <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>
      </footer>
</div>

  </body>
</html>
